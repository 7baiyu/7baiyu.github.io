---
import { Icon } from "astro-icon/components";
import { t } from "@config";
import type { PostData } from "@interfaces/data";

const { pubDate, badge, word, time, url } = Astro.props as PostData & { url?: string };

// 计算：这个 PostInfo 对应的文章 URL，是否就是当前正在浏览的页面
const postPath = url ? new URL(url, Astro.url).pathname : "";
const isCurrentPage = postPath && (postPath === Astro.url.pathname);
---

<div class="flex flex-col sm:flex-row sm:justify-between gap-y-2 mb-4 text-xs sm:text-sm opacity-75">
  <div class="flex flex-wrap items-center gap-x-4 gap-y-2">
    {pubDate && (
      <span class="flex items-center gap-1">
        <Icon name="lucide:calendar" class="h-4 w-4 flex-shrink-0" />
        <span class="truncate">{pubDate}</span>
      </span>
    )}
    {badge && (
      <span class="flex flex-wrap items-center gap-1">
        <Icon name="lucide:bookmark" class="h-4 w-4 flex-shrink-0" />
        <span class="truncate">{badge}</span>
      </span>
    )}
  </div>

  <div class="flex flex-wrap items-center gap-x-4 gap-y-2">
    <div class="flex items-center gap-1">
      <Icon name="lucide:book-open" class="h-4 w-4 flex-shrink-0" />
      <span class="truncate">{word} {t("label.wordCount")} · {time} {t("label.readTime")}</span>
    </div>

    {/* ✅ 仅在“文章详情页”显示 Busuanzi 的 page_pv；列表页不展示，避免一直‘加载中…’ */}
    {isCurrentPage && (
      <div class="flex items-center gap-1">
        <Icon name="lucide:eye" class="h-4 w-4 flex-shrink-0" />
        <span class="truncate">
          <span id="busuanzi_value_page_pv">加载中...</span> 次阅读
        </span>
      </div>
    )}
  </div>
</div>
